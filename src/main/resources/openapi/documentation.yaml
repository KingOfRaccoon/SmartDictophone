openapi: 3.1.0
info:
  title: Smart Dictophone API
  version: 1.0.0
  description: |
    # Smart Dictophone API

    REST API –¥–ª—è —É–º–Ω–æ–≥–æ –¥–∏–∫—Ç–æ—Ñ–æ–Ω–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–µ–π –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–µ–π –∑–∞–ø–∏—Å–µ–π.

    ## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
    - üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Keycloak (JWT)
    - üìÅ –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∑–∞–ø–∏—Å–µ–π –ø–æ –ø–∞–ø–∫–∞–º
    - üéôÔ∏è –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞—É–¥–∏–æ—Ñ–∞–π–ª–æ–≤
    - üìù –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è
    - üìÑ –≠–∫—Å–ø–æ—Ä—Ç —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–π –≤ PDF
    - üîç –ü–æ–∏—Å–∫ –ø–æ –∑–∞–ø–∏—Å—è–º
    - üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

    ## –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
    API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Keycloak –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ `/login` –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization: Bearer {token}`.

    ## –§–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö
    - –ê—É–¥–∏–æ—Ñ–∞–π–ª—ã: –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ñ–æ—Ä–º–∞—Ç M4A
    - –î–∞—Ç—ã: ISO-8601 —Ñ–æ—Ä–º–∞—Ç (YYYY-MM-DDTHH:mm:ssZ)
    - –ü–∞–≥–∏–Ω–∞—Ü–∏—è: page –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 0, size –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20
  contact:
    name: Smart Dictophone Support
    email: support@smartdictophone.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
servers:
- url: https://api.smartdictophone.com
  description: Production
- url: http://localhost:8888
  description: –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

paths:
  # Health check
  /:
    get:
      summary: API –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
      description: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± API –∏ —Å—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
      tags:
        - System
      responses:
        '200':
          description: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± API
          content:
            text/plain:
              schema:
                type: string
              example: |
                Smart Dictophone API v1.0 (Keycloak Integration)

                API Documentation:
                - Swagger UI: /swagger-ui
                - OpenAPI JSON (generated): /openapi.json

  /health:
    get:
      summary: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞
      description: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ API —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
      tags:
        - System
      responses:
        '200':
          description: –°–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "healthy"

  # Authentication
  /register:
    post:
      summary: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      description: –°–æ–∑–¥–∞—ë—Ç –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Keycloak –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Ö–æ–¥
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
            example:
              username: "john_doe"
              email: "john@example.com"
              password: "SecurePass123"
              firstName: "John"
              lastName: "Doe"
      responses:
        '201':
          description: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω –∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RegisterResponse'
        '400':
          description: –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email –∏–ª–∏ username —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /login:
    post:
      summary: –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
      description: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ Keycloak –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–æ–≤
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
            example:
              email: "john@example.com"
              password: "SecurePass123"
      responses:
        '200':
          description: –£—Å–ø–µ—à–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è JWT —Ç–æ–∫–µ–Ω—ã
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenResponse'
        '400':
          description: –ù–µ —É–∫–∞–∑–∞–Ω email –∏–ª–∏ –ø–∞—Ä–æ–ª—å
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: –ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /refresh:
    post:
      summary: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
      description: –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ access —Ç–æ–∫–µ–Ω–∞ —Å –ø–æ–º–æ—â—å—é refresh —Ç–æ–∫–µ–Ω–∞
      tags:
        - Authentication
      security:
        - BearerAuth: []
      responses:
        '200':
          description: –ù–æ–≤—ã–π access —Ç–æ–∫–µ–Ω —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenResponse'
        '400':
          description: Refresh —Ç–æ–∫–µ–Ω –Ω–µ —É–∫–∞–∑–∞–Ω
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π –∏–ª–∏ –∏—Å—Ç—ë–∫—à–∏–π refresh —Ç–æ–∫–µ–Ω
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /loginOnToken:
    post:
      summary: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω –∏ –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      description: –í–∞–ª–∏–¥–∞—Ü–∏—è JWT —Ç–æ–∫–µ–Ω–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
      tags:
        - Authentication
      security:
        - BearerAuth: []
      responses:
        '200':
          description: –¢–æ–∫–µ–Ω –≤–∞–ª–∏–¥–µ–Ω, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserInfo'
        '401':
          description: –ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π —Ç–æ–∫–µ–Ω
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # User Management
  /recordInfo:
    get:
      summary: –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      description: |
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –∏–∑ JWT —Ç–æ–∫–µ–Ω–∞ Keycloak –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∑–∞–ø–∏—Å–µ–π.
        –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –ø–∞–ø–∫–∏ (–ò–∑–±—Ä–∞–Ω–Ω–æ–µ, –ê—Ä—Ö–∏–≤, –ö–æ—Ä–∑–∏–Ω–∞).
      tags:
        - Users
      security:
        - BearerAuth: []
      responses:
        '200':
          description: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserInfo'
              example:
                keycloakUserId: "550e8400-e29b-41d4-a716-446655440000"
                username: "john_doe"
                email: "john@example.com"
                fullName: "John Doe"
                countRecords: 42
                countMinutes: 180
        '401':
          description: –ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # Folders
  /folders:
    get:
      summary: –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ø–∞–ø–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      description: |
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–∞–ø–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. 
        –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –ø–∞–ø–∫–∏ (–ò–∑–±—Ä–∞–Ω–Ω–æ–µ, –ê—Ä—Ö–∏–≤, –ö–æ—Ä–∑–∏–Ω–∞).
      tags:
        - Folders
      security:
        - BearerAuth: []
      responses:
        '200':
          description: –°–ø–∏—Å–æ–∫ –ø–∞–ø–æ–∫
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Folder'
              example:
                - id: 1
                  keycloakUserId: "550e8400-e29b-41d4-a716-446655440000"
                  name: "–ò–∑–±—Ä–∞–Ω–Ω–æ–µ"
                  description: "–ò–∑–±—Ä–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏"
                  createdAt: "2024-01-01T00:00:00Z"
                  updatedAt: "2024-01-01T00:00:00Z"
                - id: 2
                  keycloakUserId: "550e8400-e29b-41d4-a716-446655440000"
                  name: "–†–∞–±–æ—á–∏–µ –≤—Å—Ç—Ä–µ—á–∏"
                  description: "–ó–∞–ø–∏—Å–∏ —Å —Ä–∞–±–æ—á–∏—Ö –≤—Å—Ç—Ä–µ—á"
                  createdAt: "2024-01-01T12:00:00Z"
                  updatedAt: "2024-01-01T12:00:00Z"
        '401':
          description: –ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      summary: –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –ø–∞–ø–∫—É
      description: –°–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é –ø–∞–ø–∫—É –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∑–∞–ø–∏—Å–µ–π
      tags:
        - Folders
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FolderCreateRequest'
            example:
              name: "–†–∞–±–æ—á–∏–µ –∑–∞–ø–∏—Å–∏"
              description: "–ó–∞–ø–∏—Å–∏ —Å —Ä–∞–±–æ—á–∏—Ö –≤—Å—Ç—Ä–µ—á"
      responses:
        '201':
          description: –ü–∞–ø–∫–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Folder'
        '400':
          description: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–ø—É—Å—Ç–æ–µ –∏–º—è –∏–ª–∏ –æ—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: –ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # Records
  /records:
    get:
      summary: –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π
      description: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∞—É–¥–∏–æ–∑–∞–ø–∏—Å–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø–æ–∏—Å–∫–∞, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
      tags:
        - Records
      security:
        - BearerAuth: []
      parameters:
        - name: search
          in: query
          description: –ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ –æ–ø–∏—Å–∞–Ω–∏—é
          required: false
          schema:
            type: string
          example: "—Å–æ–≤–µ—â–∞–Ω–∏–µ"
        - name: folderId
          in: query
          description: ID –ø–∞–ø–∫–∏ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
          required: false
          schema:
            type: integer
          example: 1
        - name: page
          in: query
          description: –ù–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–Ω–∞—á–∏–Ω–∞—è —Å 0)
          required: false
          schema:
            type: integer
            minimum: 0
            default: 0
          example: 0
        - name: size
          in: query
          description: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20)
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          example: 20
      responses:
        '200':
          description: –°–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedRecordsResponse'
        '401':
          description: –ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      summary: –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å
      description: |
        –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∞—É–¥–∏–æ—Ñ–∞–π–ª –∏ —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å. 
        –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ S3 –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∑–∞–¥–∞—á–∞ –Ω–∞ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—é.
      tags:
        - Records
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/RecordCreateRequest'
      responses:
        '201':
          description: –ó–∞–ø–∏—Å—å —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞ –∏ –∞—É–¥–∏–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Record'
        '400':
          description: –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –∏–ª–∏ –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: –ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–∞–ø–∫–µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: –ü–∞–ø–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /records/{id}/audio:
    get:
      summary: –°–∫–∞—á–∞—Ç—å –∞—É–¥–∏–æ—Ñ–∞–π–ª –∑–∞–ø–∏—Å–∏
      description: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞—É–¥–∏–æ—Ñ–∞–π–ª –≤ —Ñ–æ—Ä–º–∞—Ç–µ M4A
      tags:
        - Records
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID –∑–∞–ø–∏—Å–∏
          required: true
          schema:
            type: integer
          example: 123
      responses:
        '200':
          description: –ê—É–¥–∏–æ—Ñ–∞–π–ª (audio/m4a)
          content:
            audio/m4a:
              schema:
                type: string
                format: binary
        '400':
          description: –ù–µ–≤–µ—Ä–Ω—ã–π ID –∑–∞–ø–∏—Å–∏
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: –ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π –∑–∞–ø–∏—Å–∏
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: –ó–∞–ø–∏—Å—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /records/{id}/pdf:
    get:
      summary: –°–∫–∞—á–∞—Ç—å PDF —Å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–µ–π
      description: –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç PDF —Ñ–∞–π–ª —Å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–µ–π –∑–∞–ø–∏—Å–∏
      tags:
        - Records
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID –∑–∞–ø–∏—Å–∏
          required: true
          schema:
            type: integer
          example: 123
      responses:
        '200':
          description: PDF —Ñ–∞–π–ª —Å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–µ–π
          content:
            application/pdf:
              schema:
                type: string
                format: binary
        '400':
          description: –ù–µ–≤–µ—Ä–Ω—ã–π ID –∑–∞–ø–∏—Å–∏
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: –ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π –∑–∞–ø–∏—Å–∏
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: –ó–∞–ø–∏—Å—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –∏–ª–∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: –û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ PDF
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /records/{id}/transcribe:
    post:
      summary: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ (ML Service)
      description: |
        –≠–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è ML —Å–µ—Ä–≤–∏—Å–∞ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏.
        –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–µ–≥–º–µ–Ω—Ç—ã —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏.
        –¢—Ä–µ–±—É–µ—Ç—Å—è API –∫–ª—é—á –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ X-API-Key.
      tags:
        - Records
        - ML Service
      security:
        - ApiKeyAuth: []
      parameters:
        - name: id
          in: path
          description: ID –∑–∞–ø–∏—Å–∏
          required: true
          schema:
            type: integer
          example: 123
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TranscribeRequest'
            example:
              segments:
                - start: 0.0
                  end: 5.2
                  text: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ —Å–æ–≤–µ—â–∞–Ω–∏–µ"
                - start: 5.2
                  end: 12.8
                  text: "–°–µ–≥–æ–¥–Ω—è –º—ã –æ–±—Å—É–¥–∏–º –ø–ª–∞–Ω—ã –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –∫–≤–∞—Ä—Ç–∞–ª"
      responses:
        '200':
          description: –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Transcription saved successfully"
        '400':
          description: –ù–µ–≤–µ—Ä–Ω—ã–π ID –∑–∞–ø–∏—Å–∏ –∏–ª–∏ –ø—É—Å—Ç—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: –ù–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: –ó–∞–ø–∏—Å—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT —Ç–æ–∫–µ–Ω –æ—Ç Keycloak. –ü–æ–ª—É—á–∏—Ç–µ —á–µ—Ä–µ–∑ POST /login
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
      description: API –∫–ª—é—á –¥–ª—è ML —Å–µ—Ä–≤–∏—Å–∞ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)

  schemas:
    # Request/Response models
    RegisterRequest:
      type: object
      required:
        - username
        - email
        - password
      properties:
        username:
          type: string
          description: –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
          example: "john_doe"
        email:
          type: string
          format: email
          description: Email –∞–¥—Ä–µ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
          example: "john@example.com"
        password:
          type: string
          format: password
          minLength: 8
          description: –ü–∞—Ä–æ–ª—å (–º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤)
          example: "SecurePass123"
        firstName:
          type: string
          description: –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
          example: "John"
        lastName:
          type: string
          description: –§–∞–º–∏–ª–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
          example: "Doe"

    LoginRequest:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
          description: Email –∞–¥—Ä–µ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
          example: "john@example.com"
        password:
          type: string
          format: password
          description: –ü–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
          example: "SecurePass123"

    TokenResponse:
      type: object
      properties:
        accessToken:
          type: string
          description: JWT access —Ç–æ–∫–µ–Ω
        refreshToken:
          type: string
          description: JWT refresh —Ç–æ–∫–µ–Ω
        expiresIn:
          type: integer
          description: –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ access —Ç–æ–∫–µ–Ω–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
        tokenType:
          type: string
          description: –¢–∏–ø —Ç–æ–∫–µ–Ω–∞
          example: "Bearer"

    RegisterResponse:
      type: object
      properties:
        userId:
          type: string
          description: ID —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        accessToken:
          type: string
          description: JWT access —Ç–æ–∫–µ–Ω
        refreshToken:
          type: string
          description: JWT refresh —Ç–æ–∫–µ–Ω
        expiresIn:
          type: integer
          description: –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ access —Ç–æ–∫–µ–Ω–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
        message:
          type: string
          description: –°–æ–æ–±—â–µ–Ω–∏–µ –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

    UserInfo:
      type: object
      properties:
        keycloakUserId:
          type: string
          description: ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Keycloak
          example: "550e8400-e29b-41d4-a716-446655440000"
        username:
          type: string
          description: –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
          example: "john_doe"
        email:
          type: string
          format: email
          description: Email –∞–¥—Ä–µ—Å
          example: "john@example.com"
        fullName:
          type: string
          description: –ü–æ–ª–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
          example: "John Doe"
        countRecords:
          type: integer
          description: –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π
          example: 42
        countMinutes:
          type: integer
          description: –û–±—â–∞—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø–∏—Å–µ–π –≤ –º–∏–Ω—É—Ç–∞—Ö
          example: 180

    Folder:
      type: object
      properties:
        id:
          type: integer
          description: –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–∞–ø–∫–∏
        keycloakUserId:
          type: string
          description: ID –≤–ª–∞–¥–µ–ª—å—Ü–∞ –ø–∞–ø–∫–∏
        name:
          type: string
          description: –ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏
          example: "–†–∞–±–æ—á–∏–µ –≤—Å—Ç—Ä–µ—á–∏"
        description:
          type: string
          description: –û–ø–∏—Å–∞–Ω–∏–µ –ø–∞–ø–∫–∏
          example: "–ó–∞–ø–∏—Å–∏ —Å —Ä–∞–±–æ—á–∏—Ö —Å–æ–≤–µ—â–∞–Ω–∏–π"
        createdAt:
          type: string
          format: date-time
          description: –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è
        updatedAt:
          type: string
          format: date-time
          description: –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

    FolderCreateRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 255
          description: –ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏
          example: "–†–∞–±–æ—á–∏–µ –∑–∞–ø–∏—Å–∏"
        description:
          type: string
          maxLength: 1000
          description: –û–ø–∏—Å–∞–Ω–∏–µ –ø–∞–ø–∫–∏
          example: "–ó–∞–ø–∏—Å–∏ —Å —Ä–∞–±–æ—á–∏—Ö –≤—Å—Ç—Ä–µ—á"

    Record:
      type: object
      properties:
        id:
          type: integer
          description: –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–ø–∏—Å–∏
        keycloakUserId:
          type: string
          description: ID –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∑–∞–ø–∏—Å–∏
        folderId:
          type: integer
          description: ID –ø–∞–ø–∫–∏, –≤ –∫–æ—Ç–æ—Ä–æ–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∑–∞–ø–∏—Å—å
        name:
          type: string
          description: –ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏
          example: "–°–æ–≤–µ—â–∞–Ω–∏–µ –ø–æ –ø—Ä–æ–µ–∫—Ç—É"
        datetime:
          type: string
          format: date-time
          description: –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –∑–∞–ø–∏—Å–∏
        category:
          $ref: '#/components/schemas/RecordCategory'
        place:
          type: string
          description: –ú–µ—Å—Ç–æ –∑–∞–ø–∏—Å–∏
          example: "–û—Ñ–∏—Å, –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω–∞—è 1"
        filePath:
          type: string
          description: –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –≤ S3
          example: "123.m4a"
        transcriptionText:
          type: string
          description: –¢–µ–∫—Å—Ç —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)
        createdAt:
          type: string
          format: date-time
          description: –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏
        updatedAt:
          type: string
          format: date-time
          description: –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

    RecordCategory:
      type: string
      enum:
        - MEETING
        - LECTURE
        - INTERVIEW
        - NOTE
        - OTHER
      description: |
        –ö–∞—Ç–µ–≥–æ—Ä–∏—è –∑–∞–ø–∏—Å–∏:
        - MEETING: –°–æ–≤–µ—â–∞–Ω–∏–µ/–≤—Å—Ç—Ä–µ—á–∞
        - LECTURE: –õ–µ–∫—Ü–∏—è/–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è
        - INTERVIEW: –ò–Ω—Ç–µ—Ä–≤—å—é
        - NOTE: –ó–∞–º–µ—Ç–∫–∞
        - OTHER: –î—Ä—É–≥–æ–µ

    RecordCreateRequest:
      type: object
      required:
        - recordFile
        - name
        - datetime
        - category
        - folderId
      properties:
        recordFile:
          type: string
          format: binary
          description: –ê—É–¥–∏–æ—Ñ–∞–π–ª –≤ —Ñ–æ—Ä–º–∞—Ç–µ M4A
        name:
          type: string
          minLength: 1
          maxLength: 255
          description: –ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏
          example: "–°–æ–≤–µ—â–∞–Ω–∏–µ –ø–æ –ø—Ä–æ–µ–∫—Ç—É"
        datetime:
          type: string
          format: date-time
          description: –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –∑–∞–ø–∏—Å–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ ISO-8601
          example: "2024-01-15T14:30:00Z"
        category:
          $ref: '#/components/schemas/RecordCategory'
        folderId:
          type: integer
          description: ID –ø–∞–ø–∫–∏ –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏
          example: 1
        place:
          type: string
          maxLength: 500
          description: –ú–µ—Å—Ç–æ –∑–∞–ø–∏—Å–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
          example: "–û—Ñ–∏—Å, –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω–∞—è 1"

    PaginatedRecordsResponse:
      type: object
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/Record'
        totalElements:
          type: integer
          description: –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
          example: 42
        totalPages:
          type: integer
          description: –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü
          example: 3

    TranscribeRequest:
      type: object
      required:
        - segments
      properties:
        segments:
          type: array
          items:
            $ref: '#/components/schemas/TranscriptionSegment'
          description: –ú–∞—Å—Å–∏–≤ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏

    TranscriptionSegment:
      type: object
      required:
        - start
        - end
        - text
      properties:
        start:
          type: number
          format: float
          description: –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ —Å–µ–≥–º–µ–Ω—Ç–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
          example: 0.0
        end:
          type: number
          format: float
          description: –í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è —Å–µ–≥–º–µ–Ω—Ç–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
          example: 5.2
        text:
          type: string
          description: –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç —Å–µ–≥–º–µ–Ω—Ç–∞
          example: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ —Å–æ–≤–µ—â–∞–Ω–∏–µ"

    ErrorResponse:
      type: object
      properties:
        error:
          type: string
          description: –û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏
          example: "Invalid token"
        code:
          type: integer
          description: –ö–æ–¥ –æ—à–∏–±–∫–∏
          example: 401
        timestamp:
          type: string
          format: date-time
          description: –í—Ä–µ–º—è –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –æ—à–∏–±–∫–∏

  examples:
    UserInfoExample:
      value:
        keycloakUserId: "550e8400-e29b-41d4-a716-446655440000"
        username: "john_doe"
        email: "john@example.com"
        fullName: "John Doe"
        countRecords: 42
        countMinutes: 180

    FolderExample:
      value:
        id: 1
        keycloakUserId: "550e8400-e29b-41d4-a716-446655440000"
        name: "–†–∞–±–æ—á–∏–µ –≤—Å—Ç—Ä–µ—á–∏"
        description: "–ó–∞–ø–∏—Å–∏ —Å —Ä–∞–±–æ—á–∏—Ö —Å–æ–≤–µ—â–∞–Ω–∏–π"
        createdAt: "2024-01-01T12:00:00Z"
        updatedAt: "2024-01-01T12:00:00Z"

    RecordExample:
      value:
        id: 123
        keycloakUserId: "550e8400-e29b-41d4-a716-446655440000"
        folderId: 1
        name: "–°–æ–≤–µ—â–∞–Ω–∏–µ –ø–æ –ø—Ä–æ–µ–∫—Ç—É"
        datetime: "2024-01-15T14:30:00Z"
        category: "MEETING"
        place: "–û—Ñ–∏—Å, –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω–∞—è 1"
        filePath: "123.m4a"
        transcriptionText: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ —Å–æ–≤–µ—â–∞–Ω–∏–µ..."
        createdAt: "2024-01-15T14:30:00Z"
        updatedAt: "2024-01-15T14:35:00Z"